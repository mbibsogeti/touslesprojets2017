<!DOCTYPE html>
<html>
<head>
<!-- Cette balise d'encodage 'meta charset' doit être dans les 1024 premiers octets du fichier --> 
<meta charset="utf-8">
<title>African trips: South Africa</title>
<script src="js/angular.min.js"></script>
<script src="js/angular-route.min.js"></script>
<script src="js/angular-animate.min.js"></script>
<style>
.view {
/* ici, absolute permet de gérer le flux de html pour éviter d'empiler la page disparaissant avec celle apparaissant */
	position:absolute;
	width:80%;
	transition:0.3s;
	background:#ddd;
}
.view.ng-enter {
	opacity:0
}
.view.ng-enter-active {
	opacity:1
}
.view.ng-leave {
	opacity:1
}
view.ng-leave-active {
	opacity:0
}
</style>
<!-- NB : defer implique que le contenu de cette balise ne sera lu qu'une fois la page chargée. -->
<script defer>
angular
	.module("appSA",["ngRoute","ngAnimate"])
	.config(function($routeProvider) {
		/* $routeProvider doit être configuré avec des routes. Ces routes commencent toujours par "/", template est ce qui sera affiché */
		$routeProvider
			.when("/index",{controller:"CtlSA",template:function() {
				return "<h2>Where would you like to travel?</h2>"
				+"<p>Welcome on our index page. We offer here a great deal of trips around SA.</p><br>"
				+"<a href='southafrica.html#!/dests'>Check our offer here</a><br>"
				+"<a href='southafrica.html#!/pictures'>Maybe you just wanna some pictures</a>";
			}})
			.when("/dests",{controller:"CtlSA",templateUrl:"southafrica/dests.html",controllerAs:"c"})
			.when("/dests/:id",{controller:"CtlSA",templateUrl:"southafrica/details.html",controllerAs:"c"})
			.when("/pictures",{controller:"CtlSA",templateUrl:"southafrica/pictures.html",controllerAs:"c"})
			/* cas par défaut : renvoie vers l'index quand on met ...southafrica.html dans navigateur. On pourrait renvoyer vers une page 404 */
			.otherwise({redirectTo:"/index"})
	})
	/* déclaration et initialisation de la constante "destinations" */
	.constant("destinations",[
		{name:'CapeTown',desc:'Coastal Town',id:1},
		{name:'SimonsTown',desc:'Coastal Town',id:2},
		{name:'Praetoria',desc:'Innerland Town',id:3},
		{name:'Johannesburg',desc:'Innerland Town',id:4},
		{name:'Addo',desc:'Natural Park',id:5},
		{name:'Kruger',desc:'Natural Park',id:6}
	])
	/* injection de "destinations" dans le controller */
	.controller("CtlSA",function($routeParams,destinations) {
		this.dests=destinations
		for (i in this.dests) {
			if (this.dests[i].id == $routeParams.id) {
				this.dest=this.dests[i]
			}
		}
	})
</script>
</head>
<body style="background: #eef" data-ng-app="appSA">
	<h1>Welcome on our South African trips.</h1>
	<!-- ng-view permettra d'afficher ce que l'on veut en fonction du code JS -->
		<div data-ng-controller="CtlSA as c" class="view" data-ng-view>	
		</div>
	<div data-ng-include="'footer.html'"></div>
</body>
</html>